<div class="row">
  <div class="col-lg-12 col-md-12">
    <ba-card title="文章列表" baCardClass="with-scroll table-panel">
      <div class="contnet-top-tools">
        <div class="pull-left">
          <div class="btn-group">
            <button type="button"
                    class="btn btn-default active"
                    [ngClass]="{ 'active': getParams.state == 'all'}"
                    (click)="switchState('all')">
              <span>全部</span>
              <span *ngIf="getParams.state == 'all'">({{ articles.pagination.total || 0 }})</span>
            </button>
            <button type="button"
                    class="btn btn-default"
                    [ngClass]="{ 'active': getParams.state == 1 }"
                    (click)="switchState(1)">
              <span>已发布</span>
              <span *ngIf="getParams.state == 1">({{ articles.pagination.total || 0 }})</span>
            </button>
            <button type="button"
                    class="btn btn-default"
                    [ngClass]="{ 'active': getParams.state == 0 }"
                    (click)="switchState(0)">
              <span>草稿</span>
              <span *ngIf="getParams.state == 0">({{ articles.pagination.total || 0 }})</span>
            </button>
            <button type="button"
                    class="btn btn-default"
                    [ngClass]="{ 'active': getParams.state == -1 }"
                    (click)="switchState(-1)">
              <span>回收站</span>
              <span *ngIf="getParams.state == -1">({{ articles.pagination.total || 0 }})</span>
            </button>
          </div>
          <span>&nbsp;</span>
          <div class="btn-group">
            <button type="button" 
                    class="btn btn-default btn-with-icon"
                    (click)="refreshArticles()">
              <i class="ion-refresh"></i>
              <span>刷新</span>
            </button>
            <button type="button" 
                    class="btn btn-default btn-with-icon"
                    (click)="resetGetParams()">
              <i class="ion-trash-b"></i>
              <span>清空搜索条件</span>
            </button>
            <div class="btn-group" dropdown>
              <button type="button" 
                      class="btn btn-default"
                      addToggleClass="true"
                      dropdownToggle
                      [disabled]="!selectedArticles.length">
                <i class="ion-ios-list"></i>
                <span>批量操作</span>
              </button>
              <ul class="dropdown-menu" dropdownMenu>
                <li class="dropdown-item">
                  <a [href]="">移至回收站</a>
                </li>
                <li class="dropdown-item">
                  <a [href]="">彻底删除</a>
                </li>
                <li class="dropdown-item">
                  <a [href]="">批量还原</a>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <form class="pull-right form-inline article-get-form"
              [formGroup]="searchForm" 
              (ngSubmit)="searchArticles(searchForm.value)">
          <div class="input-group">
            <input type="text"
                   [formControl]="keyword" 
                   class="form-control with-default-addon" 
                   placeholder="文章标题、描述">
            <span class="input-group-btn">
              <button class="btn btn-default" type="submit">搜索</button>
            </span>
          </div>
        </form>
        <span class="pull-right">&nbsp;&nbsp;&nbsp;</span>
        <div class="pull-right form-inline">
          <select class="form-control c-select" disabled *ngIf="false">
            <option default>创建时间</option>
            <option>浏览次数</option>
            <option>评论条数</option>
          </select>
          <span>&nbsp;</span>
          <select class="form-control c-select" [(ngModel)]="getParams.category">
            <option default value="all">所有分类</option>
            <template [ngIf]="categories && categories.data.length">
              <option *ngFor="let cate of categories.data" [ngValue]="cate._id">
                <span *ngIf="cate.level">└</span>
                <span *ngFor="let num of categoryLevelMark(cate.level)">─</span>
                <span>{{ cate.name }}</span>
              </option>
            </template>
          </select>
          <span>&nbsp;</span>
          <select class="form-control c-select" [(ngModel)]="getParams.tag">
            <option default value="all">所有标签</option>
            <template [ngIf]="tags && tags.data.length">
              <option *ngFor="let tag of tags.data" [ngValue]="tag._id">
                <span>{{ tag.name }}</span>
              </option>
            </template>
          </select>
        </div>
      </div>
      <div class="table-responsive">
        <div class="article-list">
          <table class="table tablehover table-striped table-no-borders black-muted-bg table-enrich">
            <thead class="thead-inverse">
              <tr>
                <th>
                  <ba-checkbox [(ngModel)]="articlesSelectAll" (ngModelChange)="batchSelectChange($event)">
                    <span ba-checkbox-label>
                      <span>&nbsp;</span>
                      <strong>ID</strong>
                    </span>
                  </ba-checkbox>
                </th>
                <th width="40%">标题</th>
                <th>分类目录</th>
                <th width="150">标签</th>
                <th>评论</th>
                <th>日期</th>
                <th>状态</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngIf="!articles || !articles.data.length">
                <td colspan="9">
                  <p class="text-muted text-center article-err-msg" 
                     *ngIf="articles.data.length == 0">暂无数据<p>
                </td>
              </tr>
              <template [ngIf]="articles && articles.data.length">
                <tr *ngFor="let article of articles.data">
                  <td class="batch-checkbox">
                    <ba-checkbox [(ngModel)]="article.selected" (ngModelChange)="itemSelectChange()">
                      <span ba-checkbox-label>
                        <span>&nbsp;</span>
                        <strong>{{ article.id }}</strong>
                      </span>
                    </ba-checkbox>
                  </td>
                  <td>
                    <p></p>
                    <a href="">
                      <h4>
                        <strong>{{ article.title }}</strong>
                      </h4>
                    </a>
                    <small>{{ article.description }}</small>
                  </td>
                  <td>
                    <ul class="list-unstyled">
                      <li *ngFor="let category of article.category">
                        <a href="">{{ category.name }}</a>
                      </li>
                    </ul>
                  </td>
                  <td>
                    <ul class="list-unstyled">
                      <li *ngFor="let tag of article.tag">
                        <a href="">{{ tag.name }}</a>
                      </li>
                    </ul>
                  </td>
                  <td>
                    <span>5</span> 
                    <!-- <a href="" *ngIf="article.meta.comments > 0">{{ article.meta.comments }}条评论</a> -->
                    <!-- <span *ngIf="!article.meta.comments">暂无评论</span> -->
                  </td>
                  <td>{{ article.date | dataToLocale }}</td>
                  <td>
                    <span [ngSwitch]="article.status">
                      <span *ngSwitchCase="0">草稿</span>
                      <span *ngSwitchCase="1">已发布</span>
                      <span *ngSwitchCase="'-1'">已删除</span>
                    </span>
                  </td>
                  <td>
                    <div class="button-wrapper">
                      <button class="btn btn-primary btn-sm" type="button">编辑文章</button>
                    </div>
                    <div class="button-wrapper">
                      <button class="btn btn-info btn-sm" type="button">快速编辑</button>
                    </div>
                    <div class="button-wrapper">
                      <button class="btn btn-danger btn-sm" type="button">删除文章</button>
                    </div>
                    <div class="button-wrapper">
                      <button class="btn btn-success btn-sm" type="button">查看文章</button>
                    </div>
                  </td>
                </tr>
              </template>
            </tbody>
          </table>
           <br>
          <div class="text-center">
            <pagination class="pagination-xs"
                        firstText="首页"
                        lastText="末页"
                        nextText="下一页"
                        previousText="上一页"
                        pageBtnClass="btn-primary"
                        [totalItems]="articles.pagination.total"
                        [itemsPerPage]="articles.pagination.per_page"
                        [(ngModel)]="articles.pagination.current_page"
                        [maxSize]="7"
                        [boundaryLinks]="true"
                        [rotate]="false"
                        (pageChanged)="pageChanged($event)">
            </pagination>
          </div>
        </div>
      </div>
    </ba-card>
  </div>
</div>
